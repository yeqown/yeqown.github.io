<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xl="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" version="1.1" viewBox="1061.5 -318.5 980.829 760.3739" width="980.829" height="760.3739">
  <defs>
    <font-face font-family="Helvetica Neue" font-size="12" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.9958" descent="-212.99744" font-weight="400">
      <font-face-src>
        <font-face-name name="HelveticaNeue"/>
      </font-face-src>
    </font-face>
    <marker orient="auto" overflow="visible" markerUnits="strokeWidth" id="FilledArrow_Marker" stroke-linejoin="miter" stroke-miterlimit="10" viewBox="-1 -4 10 8" markerWidth="10" markerHeight="8" color="black">
      <g>
        <path d="M 8 0 L 0 -3 L 0 3 Z" fill="currentColor" stroke="currentColor" stroke-width="1"/>
      </g>
    </marker>
    <font-face font-family="Helvetica Neue" font-size="11" panose-1="2 0 5 3 0 0 0 2 0 4" units-per-em="1000" underline-position="-100" underline-thickness="50" slope="0" x-height="517" cap-height="714" ascent="951.9958" descent="-212.99744" font-weight="400">
      <font-face-src>
        <font-face-name name="HelveticaNeue"/>
      </font-face-src>
    </font-face>
    <font-face font-family="PingFang SC" font-size="11" panose-1="2 11 4 0 0 0 0 0 0 0" units-per-em="1000" underline-position="-150" underline-thickness="58" slope="0" x-height="600" cap-height="860" ascent="1060.0021" descent="-340.0007" font-weight="400">
      <font-face-src>
        <font-face-name name="PingFangSC-Regular"/>
      </font-face-src>
    </font-face>
    <font-face font-family="PingFang SC" font-size="12" panose-1="2 11 4 0 0 0 0 0 0 0" units-per-em="1000" underline-position="-150" underline-thickness="58" slope="0" x-height="600" cap-height="860" ascent="1060.0021" descent="-340.0007" font-weight="400">
      <font-face-src>
        <font-face-name name="PingFangSC-Regular"/>
      </font-face-src>
    </font-face>
  </defs>
  <metadata> Produced by OmniGraffle 7.14.1 
    <dc:date>2020-04-14 03:44:31 +0000</dc:date>
  </metadata>
  <g id="channel" stroke="none" fill="none" fill-opacity="1" stroke-dasharray="none" stroke-opacity="1">
    <title>channel</title>
    <g id="channel: sendchan">
      <title>sendchan</title>
      <g id="Graphic_34">
        <rect x="1062" y="254" width="113.164" height="41" fill="#ccc"/>
        <rect x="1062" y="254" width="113.164" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1067 267.332)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="22.014" y="11">chansend1</tspan>
        </text>
      </g>
      <g id="Graphic_35">
        <rect x="1254" y="254" width="691" height="41" fill="#c0c0ff"/>
        <rect x="1254" y="254" width="691" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1259 267.332)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="314.268" y="11">chansend</tspan>
        </text>
      </g>
      <g id="Line_36">
        <path d="M 1175.164 274.5 C 1194.6925 274.5 1218.2346 274.5 1244.0962 274.5" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_37">
        <rect x="1426" y="-318" width="113.164" height="41" fill="#333"/>
        <rect x="1426" y="-318" width="113.164" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1431 -304.668)" fill="white">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="white" x="32.802" y="11">gopark</tspan>
        </text>
      </g>
      <g id="Group_51">
        <g id="Graphic_41">
          <rect x="1403.0901" y="-217.2221" width="130" height="35" fill="#c0ffc0"/>
          <rect x="1403.0901" y="-217.2221" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 -205.8761)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="44.919" y="10">hchan</tspan>
          </text>
        </g>
        <g id="Graphic_42">
          <rect x="1403.0901" y="-182.2221" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="-182.2221" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 -172.7221)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="19.2505" y="12">qcount </tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">缓冲数量</tspan>
          </text>
        </g>
        <g id="Graphic_43">
          <rect x="1403.0901" y="-147.2221" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="-147.2221" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 -137.7221)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="7.244" y="12">dataqsize </tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">缓冲区大小</tspan>
          </text>
        </g>
        <g id="Graphic_44">
          <rect x="1403.0901" y="-112.2221" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="-112.2221" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 -102.7221)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="23.0235" y="12">buf </tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">缓冲区地址</tspan>
          </text>
        </g>
        <g id="Graphic_45">
          <rect x="1403.0901" y="-77.2221" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="-77.2221" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 -67.7221)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="3.6745" y="12">closed </tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">缓冲区关闭标志</tspan>
          </text>
        </g>
        <g id="Graphic_47">
          <rect x="1403.0901" y="-42.222103" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="-42.222103" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 -32.722103)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="21.2965" y="12">sendx</tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12"> 发送索引</tspan>
          </text>
        </g>
        <g id="Graphic_48">
          <rect x="1403.0901" y="-7.222103" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="-7.222103" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 2.2778967)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="23.2325" y="12">recvx </tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">接收索引</tspan>
          </text>
        </g>
        <g id="Graphic_49">
          <rect x="1403.0901" y="27.777897" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="27.777897" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 37.277897)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="8.5695" y="12">recvq </tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">接收等待g列表</tspan>
          </text>
        </g>
        <g id="Graphic_50">
          <rect x="1403.0901" y="62.7779" width="130" height="35" fill="#ccc"/>
          <rect x="1403.0901" y="62.7779" width="130" height="35" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
          <text transform="translate(1408.0901 72.2779)" fill="black">
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" x="7.0295" y="12">sendq </tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">发送等待</tspan>
            <tspan font-family="Helvetica Neue" font-size="11" font-weight="400" fill="black" y="12">g</tspan>
            <tspan font-family="PingFang SC" font-size="11" font-weight="400" fill="black" y="12">列表</tspan>
          </text>
        </g>
      </g>
      <g id="Line_53">
        <path d="M 1321.6563 254.83796 C 1321.6563 254.83796 1314.8148 -94.07407 1330.3704 -147.4074 C 1337.2228 -170.90153 1364.763 -183.84848 1393.4347 -190.9815" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_56">
        <rect x="1267.3283" y="6.93364" width="106.432" height="27" fill="white"/>
        <text transform="translate(1272.3283 11.93364)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="35527137e-20" y="13">检查 hchan == nil</tspan>
        </text>
      </g>
      <g id="Line_59">
        <path d="M 1403.0901 -202.0128 C 1365.5873 -207.36938 1333.462 -222.39504 1375.8235 -262.7199 C 1391.558 -277.69795 1405.3187 -288.0085 1417.2554 -294.93332" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="4.0,4.0" stroke-width="1"/>
      </g>
      <g id="Graphic_60">
        <rect x="1299.4424" y="-263.77692" width="120.4592" height="41.336" fill="white"/>
        <text transform="translate(1304.4424 -258.77692)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="22.241603" y="11">hchan == nil</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="1.2296028" y="27.336">挂起自己，触发调度</tspan>
        </text>
      </g>
      <g id="Line_62">
        <path d="M 1386.749 254.65278 C 1386.749 254.65278 1308.8727 84.31771 1343.7037 68.88889 C 1355.715 63.56836 1374.2338 59.10959 1393.3438 55.550924" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_63">
        <rect x="1321.6505" y="187.27126" width="85.228" height="27" fill="white"/>
        <text transform="translate(1326.6505 192.27126)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">1、检查 recvq</tspan>
        </text>
      </g>
      <g id="Graphic_64">
        <rect x="1759" y="23.96148" width="130" height="41" fill="#c0c0ff"/>
        <rect x="1759" y="23.96148" width="130" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1764 37.29348)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="46.884" y="11">send</tspan>
        </text>
      </g>
      <g id="Line_65">
        <path d="M 1533.0901 45.128794 C 1594.0414 44.98898 1685.129 44.780034 1749.1029 44.633286" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-dasharray="4.0,4.0" stroke-width="1"/>
      </g>
      <g id="Graphic_66">
        <rect x="1554.7606" y="14.362941" width="188.452" height="61" fill="white"/>
        <text transform="translate(1559.7606 19.36294)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="58264504e-20" y="13">1、sg = recvq.dequeue; sg != nil</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="47.226" y="30">有等待的接收者</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="59.226" y="47">（无缓冲）</tspan>
        </text>
      </g>
      <g id="Line_68">
        <path d="M 1386.749 254.65278 C 1386.749 254.65278 1417.0602 189.85532 1417.0602 189.85532 C 1417.0602 189.85532 1440.66 139.17888 1455.7615 106.75129" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_69">
        <rect x="1357.2858" y="129.13995" width="155.608" height="44" fill="white"/>
        <text transform="translate(1362.2858 134.13995)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="8526513e-20" y="13">2、c.qcount &lt; c.dataqsize</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="30.804" y="30">（缓冲区未满）</tspan>
        </text>
      </g>
      <g id="Line_72">
        <path d="M 1889 41.04172 C 1922.925 45.6877 1958.107 63.45051 1961.4815 116.33815 C 1961.7728 120.90355 1962.0483 125.15235 1962.309 129.10351" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_73">
        <rect x="1872.501" y="79.60117" width="169.828" height="27" fill="white"/>
        <text transform="translate(1877.501 84.60117)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="6679102e-19" y="13">将接受者sg.g设置为P.runnext</tspan>
        </text>
      </g>
      <g id="Graphic_74">
        <rect x="1683" y="138.98074" width="113.164" height="41" fill="#ccc"/>
        <rect x="1683" y="138.98074" width="113.164" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1688 152.31274)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="8.112001" y="11">typedmemmove</tspan>
        </text>
      </g>
      <g id="Line_75">
        <path d="M 1528.0767 97.7779 C 1571.1215 110.33545 1629.1174 127.25468 1673.4918 140.20013" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_76">
        <rect x="1569.0631" y="107.4958" width="77.2" height="27" fill="white"/>
        <text transform="translate(1574.0631 112.4958)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="3623768e-19" y="13">2、拷贝数据</tspan>
        </text>
      </g>
      <g id="Line_77">
        <path d="M 1714.615 179.98074 C 1691.5993 198.87862 1657.2947 227.04562 1632.1204 247.71585" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_79">
        <rect x="1531.296" y="376.4068" width="136.408" height="41" fill="#ccc"/>
        <rect x="1531.296" y="376.4068" width="136.408" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1536.296 389.7388)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="4.2539986" y="11">mysg = acquireSudog</tspan>
        </text>
      </g>
      <g id="Graphic_80">
        <rect x="1634.366" y="200.67814" width="77.2" height="27" fill="white"/>
        <text transform="translate(1639.366 205.67814)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="3623768e-19" y="13">2、更新标志</tspan>
        </text>
      </g>
      <g id="Line_81">
        <path d="M 1599.5 295 C 1599.5 314.54273 1599.5 344.2137 1599.5 366.50806" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_82">
        <rect x="1552.5" y="309.445" width="94" height="44" fill="white"/>
        <text transform="translate(1557.5 314.445)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="2.4" y="13">3、非上述场景</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="30">（缓冲区已满）</tspan>
        </text>
      </g>
      <g id="Graphic_83">
        <rect x="1852" y="376.4068" width="113.164" height="41" fill="#333"/>
        <rect x="1852" y="376.4068" width="113.164" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1857 389.7388)" fill="white">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="white" x="32.802" y="11">gopark</tspan>
        </text>
      </g>
      <g id="Line_84">
        <path d="M 1667.704 396.9068 C 1719.603 396.9068 1790.6307 396.9068 1842.1 396.9068" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_85">
        <rect x="1699.9648" y="383.4068" width="114.964" height="27" fill="white"/>
        <text transform="translate(1704.9648 388.4068)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="0" y="13">sendq.enqueue(sg)</tspan>
        </text>
      </g>
      <g id="Graphic_87">
        <rect x="1730" y="-132" width="130" height="41" fill="#c0c0ff"/>
        <rect x="1730" y="-132" width="130" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1735 -118.668)" fill="black">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="black" x="31.104" y="11">sendDirect</tspan>
        </text>
      </g>
      <g id="Line_89">
        <path d="M 1771.7284 24.799443 C 1771.7284 24.799443 1731.5386 1.5037594 1730 -33.082707 C 1729.2456 -50.04095 1744.8575 -69.22161 1760.9678 -84.36842" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Line_90">
        <path d="M 1839.3643 -91 C 1859.2783 -77.44569 1876.0241 -56.90057 1864.6617 -28.57143 C 1857.096 -9.708706 1850.1181 4.6379435 1844.1566 15.401507" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_92">
        <rect x="1910" y="138.98074" width="113.164" height="41" fill="#333"/>
        <rect x="1910" y="138.98074" width="113.164" height="41" stroke="gray" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
        <text transform="translate(1915 152.31274)" fill="white">
          <tspan font-family="Helvetica Neue" font-size="12" font-weight="400" fill="white" x="29.802" y="11">goready</tspan>
        </text>
      </g>
      <g id="Graphic_94">
        <rect x="1643.9092" y="-43.25157" width="172.72" height="27" fill="white"/>
        <text transform="translate(1648.9092 -38.25157)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="58264504e-20" y="13">将元素直接拷贝到接收sg.elem</tspan>
        </text>
      </g>
      <g id="Line_95">
        <path d="M 1323.4976 293.67112 C 1323.4976 293.67112 1264.0166 443.7145 1357.2858 441.34615 C 1436.2459 439.34117 1401.5745 335.73197 1389.0776 303.98814" marker-end="url(#FilledArrow_Marker)" stroke="black" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"/>
      </g>
      <g id="Graphic_96">
        <rect x="1223.2763" y="384.61434" width="168.832" height="44" fill="white"/>
        <text transform="translate(1228.2763 389.61434)" fill="black">
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="29.862" y="13">hchan.closed != 0</tspan>
          <tspan font-family="PingFang SC" font-size="12" font-weight="400" fill="black" x="1.998" y="30">channel 已经关闭，直接返回 </tspan>
        </text>
      </g>
    </g>
  </g>
</svg>
